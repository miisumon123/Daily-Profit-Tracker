<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Qurtex 10% Daily Profit Tracker with Save Button</title>
<style>
  body { font-family: Arial, sans-serif; background: #f5f5f5; padding: 20px; }
  h2 { text-align: center; }
  table { width: 100%; border-collapse: collapse; margin-top: 20px; }
  th, td { border: 1px solid #ccc; padding: 8px; text-align: center; }
  select { padding: 4px; }
  input[type=number] { padding: 6px; width: 120px; }
  button { margin-left: 10px; padding: 8px 12px; }
</style>
</head>
<body>
  <h2>Qurtex 10% Daily Profit Tracker</h2>

  <label>
    Starting Balance: $<input type="number" id="startBalance" min="1" step="0.01" />
  </label>
  <button id="startBtn">Start Tracking</button>
  <button id="saveBtn">Save Progress</button>
  <button id="resetBtn">Reset Data</button>

  <div id="tracker"></div>

  <script>
    const startBtn = document.getElementById('startBtn');
    const saveBtn = document.getElementById('saveBtn');
    const resetBtn = document.getElementById('resetBtn');
    const startBalanceInput = document.getElementById('startBalance');
    const trackerDiv = document.getElementById('tracker');

    function saveStartBalance(val) {
      localStorage.setItem('startBalance', val);
    }
    function loadStartBalance() {
      return parseFloat(localStorage.getItem('startBalance')) || null;
    }

    function saveDayResult(day, val) {
      localStorage.setItem('dayResult_' + day, val);
    }
    function loadDayResult(day) {
      return localStorage.getItem('dayResult_' + day) || '';
    }

    function clearData() {
      localStorage.clear();
      trackerDiv.innerHTML = '';
      startBalanceInput.value = '';
    }

    // Render tracker table (without saving on change)
    function renderTracker() {
      let startBalance = parseFloat(startBalanceInput.value);
      if (isNaN(startBalance) || startBalance <= 0) {
        alert('Please enter a valid starting balance > 0');
        return;
      }

      let balance = startBalance;
      let html = '<table><thead><tr><th>Day</th><th>Result</th><th>Profit</th><th>Balance</th></tr></thead><tbody>';

      for (let day = 1; day <= 30; day++) {
        let result = loadDayResult(day);
        let profit = 0;
        if (result === 'win') {
          profit = balance * 0.10;
          balance += profit;
        } else if (result === 'lose') {
          profit = 0;
        }
        html += `<tr>
          <td>${day}</td>
          <td>
            <select id="selectDay${day}">
              <option value="" ${result === '' ? 'selected' : ''}>-</option>
              <option value="win" ${result === 'win' ? 'selected' : ''}>✅ Win</option>
              <option value="lose" ${result === 'lose' ? 'selected' : ''}>❌ Loss</option>
            </select>
          </td>
          <td>${profit === 0 ? '-' : '$' + profit.toFixed(2)}</td>
          <td>$${balance.toFixed(2)}</td>
        </tr>`;
      }

      html += '</tbody></table>';
      trackerDiv.innerHTML = html;
    }

    // Save all dropdown values on Save button click
    function saveAllResults() {
      let startBalance = parseFloat(startBalanceInput.value);
      if (isNaN(startBalance) || startBalance <= 0) {
        alert('Please enter a valid starting balance > 0 before saving.');
        return;
      }
      saveStartBalance(startBalance);

      for (let day = 1; day <= 30; day++) {
        const selectElem = document.getElementById('selectDay' + day);
        if (selectElem) {
          const val = selectElem.value;
          saveDayResult(day, val);
        }
      }
      alert('Progress saved successfully!');
      renderTracker(); // Refresh view to update profits/balances
    }

    startBtn.onclick = () => {
      renderTracker();
    };

    saveBtn.onclick = () => {
      saveAllResults();
    };

    resetBtn.onclick = () => {
      if (confirm('Are you sure you want to reset all saved data?')) {
        clearData();
      }
    };

    // Load on page load
    window.onload = () => {
      let savedStart = loadStartBalance();
      if (savedStart !== null) {
        startBalanceInput.value = savedStart;
        renderTracker();
      }
    };
  </script>
</body>
</html>
